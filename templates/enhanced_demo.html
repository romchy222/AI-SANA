<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced AI-SANA Features - Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .main-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            margin: 20px auto;
            max-width: 1200px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        
        .agent-card {
            border: none;
            border-radius: 15px;
            transition: all 0.3s ease;
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            margin-bottom: 20px;
        }
        
        .agent-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .feature-demo {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #007bff;
        }
        
        .api-result {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            border: 1px solid #e9ecef;
        }
        
        .btn-custom {
            background: linear-gradient(45deg, #007bff, #0056b3);
            border: none;
            border-radius: 25px;
            padding: 10px 25px;
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.3);
            color: white;
        }
        
        .loading {
            display: none;
        }
        
        .loading.active {
            display: inline-block;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="main-container">
            <!-- Header -->
            <div class="text-center py-4">
                <h1 class="display-4 fw-bold text-primary">
                    <i class="fas fa-robot me-3"></i>Enhanced AI-SANA Features
                </h1>
                <p class="lead text-muted">Демонстрация расширенной функциональности университетских AI-агентов</p>
            </div>

            <!-- Tabs for different agents -->
            <nav class="nav nav-pills nav-fill mb-4" id="agent-tabs">
                <button class="nav-link active" data-agent="abitur">
                    <i class="fas fa-graduation-cap me-2"></i>AI-Abitur
                </button>
                <button class="nav-link" data-agent="kadrai">
                    <i class="fas fa-users me-2"></i>KadrAI
                </button>
                <button class="nav-link" data-agent="uninav">
                    <i class="fas fa-compass me-2"></i>UniNav
                </button>
                <button class="nav-link" data-agent="career">
                    <i class="fas fa-briefcase me-2"></i>CareerNavigator
                </button>
                <button class="nav-link" data-agent="uniroom">
                    <i class="fas fa-home me-2"></i>UniRoom
                </button>
            </nav>

            <!-- Agent Content Sections -->
            <div class="tab-content p-4">
                
                <!-- AI-Abitur Section -->
                <div class="tab-pane active" id="abitur-content">
                    <div class="agent-card card">
                        <div class="card-header bg-primary text-white">
                            <h3><i class="fas fa-graduation-cap me-2"></i>AI-Abitur - Цифровой помощник абитуриентов</h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-info-circle me-2"></i>Информация о поступлении</h5>
                                        <button class="btn btn-custom" onclick="getAdmissionInfo()">
                                            <span class="loading" id="admission-loading">
                                                <i class="fas fa-spinner fa-spin me-2"></i>
                                            </span>
                                            Получить информацию
                                        </button>
                                        <div class="api-result" id="admission-result"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-file-alt me-2"></i>Шаблоны документов</h5>
                                        <button class="btn btn-custom" onclick="getAdmissionTemplates()">
                                            <span class="loading" id="templates-loading">
                                                <i class="fas fa-spinner fa-spin me-2"></i>
                                            </span>
                                            Получить шаблоны
                                        </button>
                                        <div class="api-result" id="templates-result"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-search me-2"></i>Требования к программе</h5>
                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control" id="program-name" 
                                                   placeholder="Введите название программы (например: информационные технологии)">
                                            <button class="btn btn-custom" onclick="getProgramRequirements()">
                                                <span class="loading" id="program-loading">
                                                    <i class="fas fa-spinner fa-spin me-2"></i>
                                                </span>
                                                Получить требования
                                            </button>
                                        </div>
                                        <div class="api-result" id="program-result"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- KadrAI Section -->
                <div class="tab-pane" id="kadrai-content">
                    <div class="agent-card card">
                        <div class="card-header bg-success text-white">
                            <h3><i class="fas fa-users me-2"></i>KadrAI - ИИ-ассистент по кадровым вопросам</h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-clipboard-list me-2"></i>Процедуры и регламенты</h5>
                                        <button class="btn btn-custom" onclick="getHRProcedures()">
                                            <span class="loading" id="hr-procedures-loading">
                                                <i class="fas fa-spinner fa-spin me-2"></i>
                                            </span>
                                            Получить процедуры
                                        </button>
                                        <div class="api-result" id="hr-procedures-result"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-calendar-alt me-2"></i>График отпусков</h5>
                                        <button class="btn btn-custom" onclick="getLeaveCalendar()">
                                            <span class="loading" id="leave-calendar-loading">
                                                <i class="fas fa-spinner fa-spin me-2"></i>
                                            </span>
                                            Получить график
                                        </button>
                                        <div class="api-result" id="leave-calendar-result"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- UniNav Section -->
                <div class="tab-pane" id="uninav-content">
                    <div class="agent-card card">
                        <div class="card-header bg-info text-white">
                            <h3><i class="fas fa-compass me-2"></i>UniNav - Чат-ассистент студентов</h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-calendar me-2"></i>Расписание занятий</h5>
                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control" id="group-name" 
                                                   placeholder="Группа (например: ЕТН-21-1)">
                                            <button class="btn btn-custom" onclick="getCurrentSchedule()">
                                                <span class="loading" id="schedule-loading">
                                                    <i class="fas fa-spinner fa-spin me-2"></i>
                                                </span>
                                                Получить расписание
                                            </button>
                                        </div>
                                        <div class="api-result" id="schedule-result"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-school me-2"></i>Информация о факультете</h5>
                                        <button class="btn btn-custom" onclick="getFacultyInfo()">
                                            <span class="loading" id="faculty-loading">
                                                <i class="fas fa-spinner fa-spin me-2"></i>
                                            </span>
                                            Получить информацию
                                        </button>
                                        <div class="api-result" id="faculty-result"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CareerNavigator Section -->
                <div class="tab-pane" id="career-content">
                    <div class="agent-card card">
                        <div class="card-header bg-warning text-dark">
                            <h3><i class="fas fa-briefcase me-2"></i>CareerNavigator - Ассистент по трудоустройству</h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-search me-2"></i>Поиск вакансий</h5>
                                        <button class="btn btn-custom" onclick="searchJobs()">
                                            <span class="loading" id="jobs-loading">
                                                <i class="fas fa-spinner fa-spin me-2"></i>
                                            </span>
                                            Найти вакансии
                                        </button>
                                        <div class="api-result" id="jobs-result"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-lightbulb me-2"></i>Советы по собеседованию</h5>
                                        <button class="btn btn-custom" onclick="getInterviewTips()">
                                            <span class="loading" id="tips-loading">
                                                <i class="fas fa-spinner fa-spin me-2"></i>
                                            </span>
                                            Получить советы
                                        </button>
                                        <div class="api-result" id="tips-result"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- UniRoom Section -->
                <div class="tab-pane" id="uniroom-content">
                    <div class="agent-card card">
                        <div class="card-header bg-secondary text-white">
                            <h3><i class="fas fa-home me-2"></i>UniRoom - Ассистент по общежитию</h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-bed me-2"></i>Доступные комнаты</h5>
                                        <button class="btn btn-custom" onclick="getAvailableRooms()">
                                            <span class="loading" id="rooms-loading">
                                                <i class="fas fa-spinner fa-spin me-2"></i>
                                            </span>
                                            Найти комнаты
                                        </button>
                                        <div class="api-result" id="rooms-result"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="feature-demo">
                                        <h5><i class="fas fa-rules me-2"></i>Правила проживания</h5>
                                        <button class="btn btn-custom" onclick="getHousingRules()">
                                            <span class="loading" id="rules-loading">
                                                <i class="fas fa-spinner fa-spin me-2"></i>
                                            </span>
                                            Получить правила
                                        </button>
                                        <div class="api-result" id="rules-result"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Tab switching functionality
        document.querySelectorAll('#agent-tabs .nav-link').forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs and content
                document.querySelectorAll('#agent-tabs .nav-link').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-pane').forEach(content => content.classList.remove('active'));
                
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Show corresponding content
                const agent = this.dataset.agent;
                const contentMap = {
                    'abitur': 'abitur-content',
                    'kadrai': 'kadrai-content', 
                    'uninav': 'uninav-content',
                    'career': 'career-content',
                    'uniroom': 'uniroom-content'
                };
                
                document.getElementById(contentMap[agent]).classList.add('active');
            });
        });

        // Helper function for API calls
        async function makeAPICall(endpoint, loadingId, resultId, formatter = null) {
            const loading = document.getElementById(loadingId);
            const result = document.getElementById(resultId);
            
            loading.classList.add('active');
            result.innerHTML = '';
            
            try {
                const response = await fetch(endpoint);
                const data = await response.json();
                
                if (data.success) {
                    if (formatter) {
                        result.innerHTML = formatter(data.data);
                    } else {
                        result.innerHTML = `<pre>${JSON.stringify(data.data, null, 2)}</pre>`;
                    }
                } else {
                    result.innerHTML = `<div class="alert alert-danger">Error: ${data.error}</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="alert alert-danger">Request failed: ${error.message}</div>`;
            } finally {
                loading.classList.remove('active');
            }
        }

        // AI-Abitur functions
        function getAdmissionInfo() {
            makeAPICall('/api/enhanced/abitur/admission-info', 'admission-loading', 'admission-result', 
                (data) => {
                    let html = '<h6>Контактная информация:</h6>';
                    html += `<p><strong>Телефон:</strong> ${data.contact_info.phone}<br>`;
                    html += `<strong>Email:</strong> ${data.contact_info.email}<br>`;
                    html += `<strong>Адрес:</strong> ${data.contact_info.address}<br>`;
                    html += `<strong>Время работы:</strong> ${data.contact_info.working_hours}</p>`;
                    
                    html += '<h6>Факультеты:</h6><ul>';
                    data.faculties.forEach(faculty => {
                        html += `<li><strong>${faculty.name}</strong> - ${faculty.programs} программ</li>`;
                    });
                    html += '</ul>';
                    
                    html += '<h6>Важные даты:</h6><ul>';
                    data.important_dates.forEach(date => {
                        html += `<li><strong>${date.date}:</strong> ${date.event}</li>`;
                    });
                    html += '</ul>';
                    
                    return html;
                }
            );
        }

        function getAdmissionTemplates() {
            makeAPICall('/api/enhanced/abitur/templates', 'templates-loading', 'templates-result',
                (data) => {
                    if (data.length === 0) return '<p>Шаблоны не найдены</p>';
                    
                    let html = '<h6>Доступные шаблоны документов:</h6><ul>';
                    data.forEach(template => {
                        html += `<li><strong>${template.name}</strong><br>`;
                        html += `<small class="text-muted">Категория: ${template.category}</small><br>`;
                        html += `<small>${template.instructions}</small></li>`;
                    });
                    html += '</ul>';
                    return html;
                }
            );
        }

        function getProgramRequirements() {
            const programName = document.getElementById('program-name').value;
            if (!programName) {
                alert('Введите название программы');
                return;
            }
            
            makeAPICall(`/api/enhanced/abitur/program-requirements/${encodeURIComponent(programName)}`, 
                       'program-loading', 'program-result',
                (data) => {
                    if (data.message) return `<p>${data.message}</p>`;
                    
                    let html = `<h6>Требования к программе "${programName}":</h6>`;
                    html += `<p><strong>Минимальный балл ЕНТ:</strong> ${data.min_ent_score || 'Не указан'}<br>`;
                    html += `<strong>Продолжительность:</strong> ${data.duration || 'Не указана'}<br>`;
                    html += `<strong>Язык обучения:</strong> ${data.language || 'Не указан'}<br>`;
                    html += `<strong>Стоимость:</strong> ${data.tuition_fee || 'Не указана'}</p>`;
                    
                    if (data.required_subjects) {
                        html += '<strong>Требуемые предметы:</strong><ul>';
                        data.required_subjects.forEach(subject => {
                            html += `<li>${subject}</li>`;
                        });
                        html += '</ul>';
                    }
                    
                    return html;
                }
            );
        }

        // KadrAI functions
        function getHRProcedures() {
            makeAPICall('/api/enhanced/kadrai/procedures', 'hr-procedures-loading', 'hr-procedures-result',
                (data) => {
                    let html = '<h6>Отпуска:</h6>';
                    html += `<p>Дней в году: ${data.vacation_policy.annual_days}<br>`;
                    html += `Уведомление заранее: ${data.vacation_policy.advance_notice}<br>`;
                    html += `Процесс: ${data.vacation_policy.approval_process}</p>`;
                    
                    html += '<h6>Переводы:</h6>';
                    html += `<p>Внутренний перевод: ${data.transfer_procedures.internal_transfer}<br>`;
                    html += `Время обработки: ${data.transfer_procedures.processing_time}</p>`;
                    
                    return html;
                }
            );
        }

        function getLeaveCalendar() {
            makeAPICall('/api/enhanced/kadrai/leave-calendar', 'leave-calendar-loading', 'leave-calendar-result',
                (data) => {
                    if (data.length === 0) return '<p>График отпусков пуст</p>';
                    
                    let html = '<h6>График отпусков:</h6><ul>';
                    data.forEach(leave => {
                        html += `<li><strong>${leave.employee}</strong> (${leave.department})<br>`;
                        html += `Тип: ${leave.leave_type}, ${leave.start_date} - ${leave.end_date}<br>`;
                        html += `<span class="badge bg-${leave.status === 'approved' ? 'success' : 'warning'}">${leave.status}</span></li>`;
                    });
                    html += '</ul>';
                    return html;
                }
            );
        }

        // UniNav functions
        function getCurrentSchedule() {
            const group = document.getElementById('group-name').value;
            const endpoint = group ? 
                `/api/enhanced/uninav/schedule?group=${encodeURIComponent(group)}` : 
                '/api/enhanced/uninav/schedule';
                
            makeAPICall(endpoint, 'schedule-loading', 'schedule-result',
                (data) => {
                    if (data.length === 0) return '<p>Расписание не найдено для указанной группы</p>';
                    
                    let html = '<h6>Расписание занятий:</h6><ul>';
                    data.forEach(item => {
                        html += `<li><strong>${item.title}</strong><br>`;
                        html += `Преподаватель: ${item.instructor}<br>`;
                        html += `Время: ${item.start_time} - ${item.end_time}<br>`;
                        html += `Место: ${item.location}</li>`;
                    });
                    html += '</ul>';
                    return html;
                }
            );
        }

        function getFacultyInfo() {
            makeAPICall('/api/enhanced/uninav/faculty-info', 'faculty-loading', 'faculty-result',
                (data) => {
                    if (data.faculties) {
                        let html = '<h6>Доступные факультеты:</h6><ul>';
                        data.faculties.forEach(faculty => {
                            html += `<li>${faculty}</li>`;
                        });
                        html += '</ul>';
                        return html;
                    }
                    
                    if (data.message) return `<p>${data.message}</p>`;
                    return '<p>Информация о факультетах не найдена</p>';
                }
            );
        }

        // CareerNavigator functions
        function searchJobs() {
            makeAPICall('/api/enhanced/career/jobs', 'jobs-loading', 'jobs-result',
                (data) => {
                    if (data.length === 0) return '<p>Вакансии не найдены</p>';
                    
                    let html = '<h6>Доступные вакансии:</h6>';
                    data.forEach(job => {
                        html += `<div class="card mb-2">`;
                        html += `<div class="card-body">`;
                        html += `<h6 class="card-title">${job.title}</h6>`;
                        html += `<p class="card-text">`;
                        html += `<strong>Компания:</strong> ${job.company}<br>`;
                        html += `<strong>Локация:</strong> ${job.location}<br>`;
                        html += `<strong>Тип:</strong> ${job.type}<br>`;
                        html += `<strong>Зарплата:</strong> ${job.salary_range}<br>`;
                        if (job.deadline) html += `<strong>Срок подачи:</strong> ${job.deadline}<br>`;
                        html += `</p>`;
                        if (job.required_skills && job.required_skills.length > 0) {
                            html += `<p><strong>Навыки:</strong> ${job.required_skills.join(', ')}</p>`;
                        }
                        html += `</div></div>`;
                    });
                    return html;
                }
            );
        }

        function getInterviewTips() {
            makeAPICall('/api/enhanced/career/interview-tips', 'tips-loading', 'tips-result',
                (data) => {
                    let html = '<h6>Советы по собеседованию:</h6>';
                    data.forEach(category => {
                        html += `<h6 class="mt-3">${category.category}:</h6><ul>`;
                        category.tips.forEach(tip => {
                            html += `<li>${tip}</li>`;
                        });
                        html += '</ul>';
                    });
                    return html;
                }
            );
        }

        // UniRoom functions
        function getAvailableRooms() {
            makeAPICall('/api/enhanced/uniroom/available-rooms', 'rooms-loading', 'rooms-result',
                (data) => {
                    if (data.length === 0) return '<p>Свободные комнаты не найдены</p>';
                    
                    let html = '<h6>Доступные комнаты:</h6>';
                    data.forEach(room => {
                        html += `<div class="card mb-2">`;
                        html += `<div class="card-body">`;
                        html += `<h6 class="card-title">Корпус ${room.building}, Комната ${room.room_number}</h6>`;
                        html += `<p class="card-text">`;
                        html += `<strong>Тип:</strong> ${room.type}<br>`;
                        html += `<strong>Этаж:</strong> ${room.floor}<br>`;
                        html += `<strong>Вместимость:</strong> ${room.capacity} чел.<br>`;
                        html += `<strong>Свободных мест:</strong> ${room.available_spaces}<br>`;
                        html += `<strong>Стоимость:</strong> ${room.monthly_cost} тенге/мес.<br>`;
                        html += `<strong>Депозит:</strong> ${room.deposit} тенге<br>`;
                        if (room.amenities && room.amenities.length > 0) {
                            html += `<strong>Удобства:</strong> ${room.amenities.join(', ')}<br>`;
                        }
                        html += `</p>`;
                        html += `</div></div>`;
                    });
                    return html;
                }
            );
        }

        function getHousingRules() {
            makeAPICall('/api/enhanced/uniroom/rules', 'rules-loading', 'rules-result',
                (data) => {
                    let html = '<h6>Общие правила:</h6><ul>';
                    data.general_rules.forEach(rule => {
                        html += `<li>${rule}</li>`;
                    });
                    html += '</ul>';
                    
                    html += '<h6>Правила оплаты:</h6>';
                    html += `<p>Дата оплаты: ${data.payment_rules.monthly_payment_date}<br>`;
                    html += `Штраф за просрочку: ${data.payment_rules.late_fee}<br>`;
                    html += `Возврат депозита: ${data.payment_rules.deposit_return}</p>`;
                    
                    html += '<h6>Контакты:</h6>';
                    html += `<p>Офис: ${data.contact_info.admin_office}<br>`;
                    html += `Телефон: ${data.contact_info.phone}<br>`;
                    html += `Экстренный: ${data.contact_info.emergency_phone}<br>`;
                    html += `Часы работы: ${data.contact_info.working_hours}</p>`;
                    
                    return html;
                }
            );
        }
    </script>
</body>
</html>